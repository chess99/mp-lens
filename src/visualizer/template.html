<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>__TITLE__</title>
    <!-- Placeholder -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial,
          sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f8f9fa;
      }

      #container {
        width: 100%;
        height: 100vh;
        overflow: hidden;
      }

      svg {
        width: 100%;
        height: 100%;
      }

      .node {
        cursor: pointer;
      }

      /* Style nodes based on type */
      .node circle {
        /* Default / Module */
        fill: #aec7e8; /* Light blue */
        stroke: #1f77b4; /* Darker blue */
        stroke-width: 1.5px;
      }
      .node.App circle {
        fill: #ff9896; /* Red */
        stroke: #d62728;
      }
      .node.Package circle {
        fill: #98df8a; /* Green */
        stroke: #2ca02c;
      }
      .node.Page circle {
        fill: #ffbb78; /* Orange */
        stroke: #ff7f0e;
      }
      .node.Component circle {
        fill: #bcbd22; /* Olive */
        stroke: #8c564b; /* Brownish */
      }
      /* Keep highlight style */
      .node.highlighted circle {
        fill: #ff4242;
        stroke: #972b2b;
        stroke-width: 2.5px;
      }

      .node text {
        font-size: 10px;
        font-family: sans-serif;
        fill: #333;
        text-anchor: middle; /* Center text */
        dy: 0.35em; /* Vertical alignment */
      }

      /* Style links based on type */
      .link {
        fill: none;
        stroke: #bbb; /* Lighter gray */
        stroke-opacity: 0.6;
        stroke-width: 1px;
      }
      .link.Structure {
        stroke: #555; /* Darker */
        stroke-width: 2px;
      }
      .link.Import {
        stroke: #1f77b4; /* Blue */
        stroke-dasharray: 2, 2; /* Dashed */
      }
      .link.Template {
        stroke: #ff7f0e; /* Orange */
        stroke-dasharray: 4, 2; /* Different dash */
      }
      .link.Style {
        stroke: #2ca02c; /* Green */
        stroke-dasharray: 1, 3; /* Dotted */
      }
      .link.Config {
        stroke: #9467bd; /* Purple */
        stroke-opacity: 0.4;
      }
      /* Added Resource type */
      .link.Resource {
        stroke: #e377c2; /* Pink */
        stroke-dasharray: 1, 1; /* Fine dots */
        stroke-opacity: 0.5;
      }
      /* Added WorkerEntry type */
      .link.WorkerEntry {
        stroke: #7f7f7f; /* Gray */
        stroke-width: 1.5px;
        stroke-dasharray: 5, 5; /* Dashed line */
      }

      .highlighted {
        /* Used for links connected to highlighted node */
        stroke: #ff4242 !important; /* Ensure override */
        stroke-opacity: 0.9;
        stroke-width: 2.5px !important; /* Ensure override */
      }

      .tooltip {
        position: absolute;
        background: rgba(255, 255, 255, 0.9);
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 8px;
        font-size: 12px;
        pointer-events: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        max-width: 400px; /* Allow wider */
        word-wrap: break-word; /* Wrap long paths */
        z-index: 10;
      }

      .controls {
        position: absolute;
        top: 20px;
        left: 20px;
        background: white;
        border-radius: 4px;
        padding: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        z-index: 5;
      }

      .controls label {
        margin-right: 5px;
      }

      .search-box {
        margin-top: 10px;
      }

      .legend {
        position: absolute;
        bottom: 20px;
        left: 20px;
        background: white;
        border-radius: 4px;
        padding: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        max-width: 200px;
      }

      .legend-item {
        display: flex;
        align-items: center;
        margin-bottom: 4px;
      }

      .legend-item-color {
        width: 12px;
        height: 12px;
        margin-right: 5px;
        border-radius: 50%;
        border: 1px solid #555;
      }
    </style>
  </head>
  <body>
    <div id="container"></div>

    <div class="controls">
      <div>
        <label for="zoom-range">缩放:</label>
        <input type="range" id="zoom-range" min="0.1" max="2" step="0.1" value="1" />
      </div>
      <div class="search-box">
        <input type="text" id="search-input" placeholder="搜索节点 (ID 或 标签)..." />
        <button id="search-button">搜索</button>
        <button id="reset-button">重置</button>
      </div>
    </div>

    <div class="legend">
      <h4 style="margin-top: 0">图例</h4>
      <div class="legend-item">
        <div class="legend-item-color" style="background-color: #ff9896"></div>
        <span>App</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="background-color: #98df8a"></div>
        <span>Package</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="background-color: #ffbb78"></div>
        <span>Page</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="background-color: #bcbd22"></div>
        <span>Component</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="background-color: #aec7e8"></div>
        <span>Module/File</span>
      </div>
      <hr />
      <div class="legend-item">
        <div class="legend-item-color" style="border: 2px solid #555; background: none"></div>
        <span>结构</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="border: 1px dashed #1f77b4; background: none"></div>
        <span>JS/TS/WXS Import</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="border: 1px dashed #ff7f0e; background: none"></div>
        <span>WXML Template</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="border: 1px dotted #2ca02c; background: none"></div>
        <span>WXSS Style</span>
      </div>
      <div class="legend-item">
        <div
          class="legend-item-color"
          style="border: 1px solid #9467bd; background: none; opacity: 0.4"
        ></div>
        <span>JSON Config</span>
      </div>
      <div class="legend-item">
        <div
          class="legend-item-color"
          style="border: 1px dotted #e377c2; background: none; opacity: 0.5"
        ></div>
        <span>Resource (icon)</span>
      </div>
      <div class="legend-item">
        <div class="legend-item-color" style="border: 1.5px dashed #7f7f7f; background: none"></div>
        <span>Worker Entry</span>
      </div>
    </div>

    <script>
      // This placeholder will be replaced by the generator
      window.__GRAPH_DATA__ = {};
    </script>
    <!-- __RENDER_SCRIPT__ -->
  </body>
</html>
